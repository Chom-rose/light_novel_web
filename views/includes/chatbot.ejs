<!-- Floating Chatbot -->
<button id="chatToggle"
  class="fixed bottom-4 right-4 bg-indigo-600 text-white rounded-full w-14 h-14 flex items-center justify-center shadow-lg z-50">
  ðŸ’¬
</button>

<div id="chatBox" class="hidden fixed bottom-20 right-4 w-80 bg-white rounded-xl shadow-lg border p-4 z-50">
  <div id="chatMessages" class="h-64 overflow-y-auto mb-2 text-sm"></div>
  <div class="flex gap-2">
    <input id="chatInput" class="flex-1 border rounded px-2 py-1" placeholder="à¸žà¸´à¸¡à¸žà¹Œà¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡...">
    <button id="chatSend" class="bg-indigo-600 text-white px-3 py-1 rounded">à¸ªà¹ˆà¸‡</button>
  </div>
</div>

<script>
  const toggle = document.getElementById("chatToggle");
  const chatBox = document.getElementById("chatBox");
  const input = document.getElementById("chatInput");
  const send = document.getElementById("chatSend");
  const messages = document.getElementById("chatMessages");

  toggle.onclick = () => chatBox.classList.toggle("hidden");

  function addMessage(sender, text) {
    const p = document.createElement("p");
    p.innerHTML = `<strong>${sender}:</strong> ${text}`;
    messages.appendChild(p);
    messages.scrollTop = messages.scrollHeight;
  }

  send.onclick = async () => {
    const text = input.value.trim();
    if (!text) return;
    addMessage("à¸„à¸¸à¸“", text);
    input.value = "";

    const res = await fetch("/dialogflow/chat", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ message: text })
    });
    const data = await res.json();
    addMessage("à¸šà¸­à¸—", data.reply);
  };
</script>
